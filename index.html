<!doctype html>
<html>
  <head>
    <title>pipeline.js</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
  </head>
  <body>
    <a href="#add-task">Add Task</a>
    <section id="add-task">
      Task Added
    </section>
    <script src="pipeline.js"></script>
    <script type="text/javascript">
      $(function() {
        var Logger = function() { };
        Logger.prototype.init = function(next) {
          this.next = next;
        };

        Logger.prototype.call = function(env) {
          console.log(env.path);
          this.next.call(env);
        };

        var App = function() { };
        App.prototype.call = function(env) {
          var routes = {
            '#add-task': function() {
              console.log('adding');
              $('#add-task').fadeIn(1000, function() {
                var $that = $(this);
                setTimeout(function() { $that.fadeOut(2000); }, 1000);
              });
            }
          };

          var handler = routes[env.path];

          if (handler && typeof handler === 'function') {
            handler();
          }
        };

        var app = Pipeline.init(function(plumber) {
          plumber
            .use(Logger)
            .run(new App());
        });

        $('#add-task').hide();

        $('a').click(function(e) {
          app.call({ path: $(this).attr('href') });
        });
      });
    </script>
  </body>
</html>
